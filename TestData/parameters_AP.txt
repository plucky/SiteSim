// AP aggregation equilibrium

%sig: A@100(p[a1.P$m a2.P$m a3.P$m], l[r.A$w], r[l.A]), P@100(a1[p.A], a2[p.A], a3[p.A], d[d.P$m])

%par: Volume = fibro                        // system volume

//%par: inflow = 1.e-11   S	                // M s^-1

%par: RingClosureFactor = 1.e5
%par: Resize = 1.                           // "rescale" the system volume

%par: seed = 4711                           // Eau de Cologne

%par: sim_limit = 3 time                    //  {time, event}
%par: obs_frequency = 0.0001

//%obs: ! A(s[1]), B(s[2]), S(a[1] b[2])    // a molecule
//%obs: ! S(a[.] b[.])                      // a molecule
//%obs: ? S(a[#] b[#])                      // a molecule
%obs: p maxsize [3]                         // three largest sizes
%obs: b A.l-A.r                             // a bond type
%obs: b A.p-P.a1                            // a bond type
%obs: b A.p-P.a2                            // a bond type
%obs: b A.p-P.a3                            // a bond type
%obs: b P.d-P.d                             // a bond type
//%obs: s A.l                               // a free site type
//%obs: p size [1-20]
//%obs: ? S(a[.] b[_])                      // a pattern
//%obs: ? S(a[.] b[1]), B(s[1])             // a pattern

%rep: report_fn = TestOutput/report.txt
%rep: output_fn = TestOutput/output.csv
%rep: snap_root = TestOutput/snap
%rep: numbering = serial                    // {serial, event}

