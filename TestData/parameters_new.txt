// AP aggregation equilibrium

%sig: A@100(p[a1.P$m a2.P$m a3.P$m], l[r.A$w], r[l.A]), P@100(a1[p.A], a2[p.A], a3[p.A], d[d.P$m])

%par: ReferenceVolume = fibro               // Volume reference
%par: ReferenceTemp = 37                    // Temperature reference

%par: Volume = fibro                        // system volume
%par: Temperature = 37                      // temperature in Celsius

//%par: inflow = 1.e-11   S	                // M s^-1

%par: RingClosureFactor = 1.e5              // at the reference state

%par: ResizeVolume = 0.1                    // rescale the system volume
%par: RescaleTemp = 1.                      // rescale the system temperature

%par: seed = 39012                          // rng seed

%par: canonicalize = True                   // canonicalize graphs
%par: consolidate = True                    // consolidate mixture by gathering isomorphic graphs
%par: barcode = False                       // barcode each atom (turns consolidate and canonicalize off)
%par: reproducible = True                   // add header info to snapshots to enable exact reproducibility

//%par: initial_mixture = /Users/wf7/Desktop/-CombiFluids/SiteSim/Test2/snap1.ka

//%par: sim_limit = 3 time                  // {time, event}
%par: sim_limit = 0.001 time                // {time, event}
%par: obs_frequency = 0.0001                 // observation period
%par: snap_frequency = 0.0001                 // snapshot period

// observable types
// --> %obs: ! <Kappa expression>            # of instances of fully specified molecule, given in Kappa syntax
// --> %obs: ? <Kappa pattern>               # of instances of all molecules matching a pattern
// --> %obs: ? <Kappa pattern> size [1-20]   # of instances of pattern in size classes [min-max]
// --> %obs: b <bond type>                   total # of instance of a given bond type...
// --> %obs: mb <bond type>                  total # of instance of a given bond type in maximer...
// --> %obs: s <site-type>                   # of instances of a free site type...
// --> %obs: ms <site-type>                  # of instances of a free site type in maximer...
// --> %obs: p size [1-20]                   report the size distribution in the size range [min-max]
// --> %obs: p maxsize [n]                   # of particles of each of the n largest molecules

%obs: b A.l-A.r                             // a bond type
%obs: b A.p-P.a1                            // a bond type
%obs: b A.p-P.a2                            // a bond type
%obs: b A.p-P.a3                            // a bond type

%rep: report_fn = TestOutput/report.txt
%rep: output_fn = TestOutput/output.csv
%rep: snap_root = TestOutput/snap
%rep: numbering = serial                    // {serial, event}
